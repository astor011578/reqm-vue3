import{_ as e,u as a,r as l,o as t,a as s,b as r,c as o,d as n,e as c,f as u,i,g as d,t as m,l as p,w as f,s as v,h as _,j as b,p as w,k as h,m as g,E as q,n as y,q as k,F as T,v as P,x}from"./index-e507caa2.js";import{F as R}from"./FullLoading-9a58366b.js";import{V as F}from"./ValidateText-543439cc.js";import{h as V}from"./useValidate-1451d16f.js";import{S as C,r as N,u as j}from"./xlsx-52ac7fc0.js";import{U as S}from"./UploadFiles-7762f4ed.js";import"./search-80813722.js";import"./loading-967d10a4.js";const I={key:0,class:"flex"},W=e({__name:"ReqrName",setup(e){const i=a(),d=l(localStorage.getItem("userId")),m=l({});return t((async()=>{m.value=await i.fetchUserInfo(d.value),i.setReqr(m.value)})),(e,a)=>{const l=s("el-input");return r(V)(r(m))?(o(),n("span",I,[c(l,{modelValue:r(m).name,"onUpdate:modelValue":a[0]||(a[0]=e=>r(m).name=e),disabled:""},null,8,["modelValue"])])):u("v-if",!0)}}},[["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/coreTeam/components/ReqrName.vue"]]),U={class:"flex"},A=e({__name:"PgrName",setup(e){const t=l(""),d=l({}),m=e=>{d.value=e,t.value=e.name,a().setPgr(d.value)};return(e,a)=>{const l=s("el-input");return o(),n("span",U,[u(" 顯示 Programmer name 框 "),c(l,{modelValue:r(t),"onUpdate:modelValue":a[0]||(a[0]=e=>i(t)?t.value=e:null),disabled:""},null,8,["modelValue"]),u(" 選擇 Programmer button 與搜尋對話框 "),c(r(C),{dept:"IT",onGetUserInfo:m})])}}},[["__scopeId","data-v-411d3adc"],["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/coreTeam/components/PgrName.vue"]]),B={class:"ce-title-lg"},E={class:"mt-3 mb-8"},z=e({__name:"index",setup:e=>(e,a)=>{const l=s("el-col"),t=s("el-row"),i=s("el-form-item");return o(),n("div",null,[d("span",B,m(r(p)("Define core team member")),1),d("div",E,[u(" Requester name "),c(i,{label:r(p)("Requester name")},{default:f((()=>[c(t,{class:"form-row-width"},{default:f((()=>[c(l,{span:12},{default:f((()=>[c(W)])),_:1})])),_:1})])),_:1},8,["label"]),u(" IT name "),c(i,{label:r(p)("IT name")},{default:f((()=>[c(t,{class:"form-row-width"},{default:f((()=>[c(l,{span:12},{default:f((()=>[c(A)])),_:1}),c(l,{span:12},{default:f((()=>[c(r(F),{"key-outer":"coreTeam","key-inner":"pgr"})])),_:1})])),_:1})])),_:1},8,["label"])])])}},[["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/coreTeam/index.vue"]]),G=["href"],O=(e=>(w("data-v-0feaf526"),e=e(),h(),e))((()=>d("br",null,null,-1))),D="/application/template.xlsx",L=e({__name:"Notice",setup(e){const a="./"===v.viteBasePath?D:`/reqm-vue3${D}`;return(e,l)=>{const t=s("el-alert");return o(),_(t,{type:"info",title:r(p)("How to fill out this form?"),"show-icon":"",closable:!1},{default:f((()=>[b(m(r(p)("You can download"))+" ",1),d("a",{href:r(a),class:"ce-link",download:"reqm-template"},m(r(p)("template file")),9,G),b(" "+m(r(p)(", then upload it after you complete it")),1),O,b(" "+m(r(p)("Without uploading the template, you can complete these fields then submit it")),1)])),_:1},8,["title"])}}},[["__scopeId","data-v-0feaf526"],["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/reqTable/components/Notice.vue"]]),M=e({__name:"PrintReqTable",emits:["get-need-refresh"],setup(e,{emit:t}){const n=l(null),u=a(),i=t,d=e=>{n.value.clearFiles(),e.raw=null,u.setReqTable({reqName:"",stage:"",customer:"",device:"",tester:"",equipment:"",system:"",purpose:""}),i("get-need-refresh",!0)},v=(e,a)=>{n.value.clearFiles();const l=e[0];l.uid=g(),n.value.handleStart(l)},w=e=>{if(!e.raw)return;let a=e.raw,l=new FileReader;l.onloadend=a=>{let t=l.result,s=N(t,{type:"array"}),r=s.SheetNames,o=s.Sheets[r];j.sheet_to_json(o);for(let l=2;l<=9;l++)if(void 0===o[j.encode_cell({r:l,c:3})])return q.error(p("You have not completed the request table yet")),void d(e);u.setReqTable({reqName:o[j.encode_cell({r:2,c:3})].v,stage:o[j.encode_cell({r:3,c:3})].v,customer:o[j.encode_cell({r:4,c:3})].v,device:o[j.encode_cell({r:5,c:3})].v,tester:o[j.encode_cell({r:6,c:3})].v,equipment:o[j.encode_cell({r:7,c:3})].v,system:o[j.encode_cell({r:8,c:3})].v,purpose:o[j.encode_cell({r:9,c:3})].v}),i("get-need-refresh",!0)},l.readAsArrayBuffer(a)};return(e,a)=>{const l=s("el-button"),t=s("el-upload"),u=s("el-form-item");return o(),_(u,{label:r(p)("Upload excel"),class:"block"},{default:f((()=>[c(t,{ref_key:"uploadRef",ref:n,limit:1,"on-remove":d,"auto-upload":!1,"on-exceed":v,"on-change":w,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},{trigger:f((()=>[c(l,{type:"primary",plain:""},{default:f((()=>[b(m(`${r(p)("Select file")}...`),1)])),_:1})])),_:1},512)])),_:1},8,["label"])}}},[["__scopeId","data-v-ddcda982"],["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/reqTable/components/PrintReqTable.vue"]]),Y=e({__name:"ManualReqTable",props:{refreshCode:{type:Number,default:0}},setup(e){const u=a(),i=l({}),d=e,m={reqName:{label:"Request name",type:"textarea",rows:"1"},stage:{label:"Stage"},customer:{label:"Customer"},device:{label:"Device"},tester:{label:"Tester"},equipment:{label:"Equipment"},system:{label:"System"},purpose:{label:"Purpose",type:"textarea",rows:"5"}},v=e=>u.setReqTable(i.value);return t((()=>i.value=u.getReqTable)),y(d,(e=>i.value=u.getReqTable)),(e,a)=>{const l=s("el-input"),t=s("el-col"),u=s("el-row"),d=s("el-form-item");return o(),n(T,null,k(m,((e,a)=>c(d,{key:a,label:r(p)(e.label)},{default:f((()=>[c(u,{class:"form-row-width"},{default:f((()=>[c(t,{span:12},{default:f((()=>[c(l,{modelValue:r(i)[a],"onUpdate:modelValue":e=>r(i)[a]=e,type:e.type,rows:e.rows,onChange:v},null,8,["modelValue","onUpdate:modelValue","type","rows"])])),_:2},1024),c(t,{span:12},{default:f((()=>[c(r(F),{"key-outer":"reqTable","key-inner":a},null,8,["key-inner"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["label"]))),64)}}},[["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/reqTable/components/ManualReqTable.vue"]]),$=e({__name:"PlantRadios",setup(e){const n=a(),u=l("");return t((()=>u.value=n.getPlant)),y(u,(e=>n.setPlant(u.value))),(e,a)=>{const l=s("el-radio"),t=s("el-radio-group"),n=s("el-col"),d=s("el-row"),m=s("el-form-item");return o(),_(m,{label:r(p)("Plant")},{default:f((()=>[c(d,{class:"form-row-width"},{default:f((()=>[c(n,{span:12},{default:f((()=>[c(t,{modelValue:r(u),"onUpdate:modelValue":a[0]||(a[0]=e=>i(u)?u.value=e:null)},{default:f((()=>[c(l,{label:"P1",size:"small",class:"pl-2"},{default:f((()=>[b("P1")])),_:1}),c(l,{label:"P2",size:"small"},{default:f((()=>[b("P2")])),_:1}),c(l,{label:"P3",size:"small"},{default:f((()=>[b("P3")])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(n,{span:12},{default:f((()=>[c(r(F),{"key-outer":"reqTable","key-inner":"plant"})])),_:1})])),_:1})])),_:1},8,["label"])}}},[["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/reqTable/components/PlantRadios.vue"]]),H={class:"ce-title-lg"},J={class:"p-3"},K={class:"mt-3 mb-8"},Q=e({__name:"index",setup(e){const i=a(),v=l(0),_=l([]),b=e=>{e&&v.value++},w=async e=>{_.value=Object.assign([],e),i.setAttachedFiles(_.value)};return t((()=>i.setAttachedFiles(_.value))),(e,a)=>{const l=s("el-form-item");return o(),n("div",null,[d("span",H,m(r(p)("Fill the request table")),1),u(" 提示 alert "),d("div",J,[c(r(L))]),u(" 填 Request table 可以有兩種方式:  "),d("div",K,[u(" 1. 讀 .xlsx 檔填表 "),c(r(M),{onGetNeedRefresh:b}),u(" 2. 手動輸入各項欄位 "),c(r(Y),{"refresh-code":r(v)},null,8,["refresh-code"]),u(" 再來選擇此需求是哪個廠 "),c(r($)),u(" 上傳附件 "),c(l,{label:r(p)("Attached files")},{default:f((()=>[c(r(S),{size:"small",plain:true,onGetChildren:w})])),_:1},8,["label"])])])}}},[["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/reqTable/index.vue"]]),X={class:"add-new-submit-container"},Z=e({__name:"SubmitButton",setup(e){const t=a(),u=P(),i=l(!1),d=async()=>{await t.checkEmpty(!1),await v()},v=async()=>{const e=await t.getValidate;let a=!1;for await(const[l,s]of Object.entries(e))for await(const[e,r]of Object.entries(s)){const l=t.getBenefitType;if(a=""===r,""!==r){switch(e){case"pgr":window.scrollTo({top:0,behavior:"smooth"});break;case"reqName":case"stage":case"customer":{const e="Efficiency"===l?510:560;window.scrollTo({top:e,behavior:"smooth"});break}case"device":case"tester":case"equipment":case"system":case"purpose":case"plant":{const e="Efficiency"===l?840:880;window.scrollTo({top:e,behavior:"smooth"});break}}return}}a&&await _()},_=async()=>{i.value=!0;const e=x.service({lock:!0,text:p("Loading"),background:"rgba(168, 171, 178, 0.3)"});setTimeout((async()=>{await t.submitApplication()?(q.success(p("New a request successfully")),u.replace({path:"/tables"})):(q.error(p("Failed to new a request")),u.push({path:"/reload"})),e.close(),i.value=!1}),2e3)};return(e,a)=>{const l=s("el-button");return o(),n("div",X,[c(l,{type:"primary",loading:r(i),onClick:d},{default:f((()=>[b(m(r(p)("Submit")),1)])),_:1},8,["loading"])])}}},[["__scopeId","data-v-20d5f3c4"],["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/components/SubmitButton.vue"]]),ee={id:"addnew-container",class:"ce-main-container"},ae={key:0},le=e({__name:"index",setup(e){const a=l(!1);return t((async()=>{a.value=!0,setTimeout((()=>a.value=!1),1500)})),(e,l)=>{const t=s("el-form");return o(),n("div",ee,[c(r(R),{loading:r(a)},null,8,["loading"]),r(a)?u("v-if",!0):(o(),n("div",ae,[c(t,{"label-width":"150px"},{default:f((()=>[u(" Core team members "),c(r(z)),u(" Request table "),c(r(Q))])),_:1}),u(" Submit button "),c(r(Z))]))])}}},[["__file","C:/Program Files/Workspace/reqm-vue3/src/views/add-new/index.vue"]]);export{le as default};
